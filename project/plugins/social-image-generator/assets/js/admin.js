!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=23)}([function(e,t){!function(){e.exports=this.wp.element}()},function(e,t){!function(){e.exports=this.wp.i18n}()},function(e,t){!function(){e.exports=this.wp.components}()},function(e,t,r){var n=r(15),a=r(16),o=r(17),c=r(19);e.exports=function(e,t){return n(e)||a(e,t)||o(e,t)||c()}},function(e,t){!function(){e.exports=this.regeneratorRuntime}()},function(e,t,r){"use strict";const n=r(20),a=r(21),o=r(22);function c(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function i(e,t){return t.encode?t.strict?n(e):encodeURIComponent(e):e}function l(e,t){return t.decode?a(e):e}function s(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function u(e){const t=(e=s(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function m(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function g(e,t){c((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const r=function(e){let t;switch(e.arrayFormat){case"index":return(e,r,n)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=r):n[e]=r};case"bracket":return(e,r,n)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};case"comma":case"separator":return(t,r,n)=>{const a="string"==typeof r&&r.split("").indexOf(e.arrayFormatSeparator)>-1?r.split(e.arrayFormatSeparator).map(t=>l(t,e)):null===r?r:l(r,e);n[t]=a};default:return(e,t,r)=>{void 0!==r[e]?r[e]=[].concat(r[e],t):r[e]=t}}}(t),n=Object.create(null);if("string"!=typeof e)return n;if(!(e=e.trim().replace(/^[?#&]/,"")))return n;for(const a of e.split("&")){let[e,c]=o(t.decode?a.replace(/\+/g," "):a,"=");c=void 0===c?null:["comma","separator"].includes(t.arrayFormat)?c:l(c,t),r(l(e,t),c,n)}for(const e of Object.keys(n)){const r=n[e];if("object"==typeof r&&null!==r)for(const e of Object.keys(r))r[e]=m(r[e],t);else n[e]=m(r,t)}return!1===t.sort?n:(!0===t.sort?Object.keys(n).sort():Object.keys(n).sort(t.sort)).reduce((e,t)=>{const r=n[t];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(r):e[t]=r,e},Object.create(null))}t.extract=u,t.parse=g,t.stringify=(e,t)=>{if(!e)return"";c((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=r=>t.skipNull&&null==e[r]||t.skipEmptyString&&""===e[r],n=function(e){switch(e.arrayFormat){case"index":return t=>(r,n)=>{const a=r.length;return void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[i(t,e),"[",a,"]"].join("")]:[...r,[i(t,e),"[",i(a,e),"]=",i(n,e)].join("")]};case"bracket":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[i(t,e),"[]"].join("")]:[...r,[i(t,e),"[]=",i(n,e)].join("")];case"comma":case"separator":return t=>(r,n)=>null==n||0===n.length?r:0===r.length?[[i(t,e),"=",i(n,e)].join("")]:[[r,i(n,e)].join(e.arrayFormatSeparator)];default:return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,i(t,e)]:[...r,[i(t,e),"=",i(n,e)].join("")]}}(t),a={};for(const t of Object.keys(e))r(t)||(a[t]=e[t]);const o=Object.keys(a);return!1!==t.sort&&o.sort(t.sort),o.map(r=>{const a=e[r];return void 0===a?"":null===a?i(r,t):Array.isArray(a)?a.reduce(n(r),[]).join("&"):i(r,t)+"="+i(a,t)}).filter(e=>e.length>0).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[r,n]=o(e,"#");return Object.assign({url:r.split("?")[0]||"",query:g(u(e),t)},t&&t.parseFragmentIdentifier&&n?{fragmentIdentifier:l(n,t)}:{})},t.stringifyUrl=(e,r)=>{r=Object.assign({encode:!0,strict:!0},r);const n=s(e.url).split("?")[0]||"",a=t.extract(e.url),o=t.parse(a,{sort:!1}),c=Object.assign(o,e.query);let l=t.stringify(c,r);l&&(l="?"+l);let u=function(e){let t="";const r=e.indexOf("#");return-1!==r&&(t=e.slice(r)),t}(e.url);return e.fragmentIdentifier&&(u="#"+i(e.fragmentIdentifier,r)),`${n}${l}${u}`}},function(e,t){function r(e,t,r,n,a,o,c){try{var i=e[o](c),l=i.value}catch(e){return void r(e)}i.done?t(l):Promise.resolve(l).then(n,a)}e.exports=function(e){return function(){var t=this,n=arguments;return new Promise((function(a,o){var c=e.apply(t,n);function i(e){r(c,a,o,i,l,"next",e)}function l(e){r(c,a,o,i,l,"throw",e)}i(void 0)}))}}},function(e,t){!function(){e.exports=this.wp.primitives}()},function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},function(e,t){!function(){e.exports=this.wp.mediaUtils}()},function(e,t){!function(){e.exports=this.wp.data}()},function(e,t){!function(){e.exports=this.wp.compose}()},function(e,t){!function(){e.exports=this.wp.plugins}()},function(e,t){!function(){e.exports=this.wp.editPost}()},,function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(n=(c=i.next()).done)&&(r.push(c.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw o}}return r}}},function(e,t,r){var n=r(18);e.exports=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,r){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,e=>"%"+e.charCodeAt(0).toString(16).toUpperCase())},function(e,t,r){"use strict";var n=new RegExp("%[a-f0-9]{2}","gi"),a=new RegExp("(%[a-f0-9]{2})+","gi");function o(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var r=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],o(r),o(n))}function c(e){try{return decodeURIComponent(e)}catch(a){for(var t=e.match(n),r=1;r<t.length;r++)t=(e=o(t,r).join("")).match(n);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},r=a.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch(e){var n=c(r[0]);n!==r[0]&&(t[r[0]]=n)}r=a.exec(e)}t["%C2"]="�";for(var o=Object.keys(t),i=0;i<o.length;i++){var l=o[i];e=e.replace(new RegExp(l,"g"),t[l])}return e}(e)}}},function(e,t,r){"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const r=e.indexOf(t);return-1===r?[e]:[e.slice(0,r),e.slice(r+t.length)]}},function(e,t,r){"use strict";r.r(t);var n=r(0),a=r(1),o=r(8),c=r.n(o),i=r(3),l=r.n(i),s=r(2),u=r(4),m=r.n(u),g=r(6),b=r.n(g),p=r(5),f=r.n(p),d=r(9);function O(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function j(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var v=function(e){var t=e.icon,r=e.size,a=void 0===r?24:r,o=j(e,["icon","size"]);return Object(n.cloneElement)(t,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){O(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({width:a,height:a},o))},_=r(7),h=Object(n.createElement)(_.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Object(n.createElement)(_.Path,{d:"M9 18.6L3.5 13l1-1L9 16.4l9.5-9.9 1 1z"})),w=Object(n.createElement)(_.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Object(n.createElement)(_.Path,{d:"M13 11.8l6.1-6.3-1-1-6.1 6.2-6.1-6.2-1 1 6.1 6.3-6.5 6.7 1 1 6.5-6.6 6.5 6.6 1-1z"})),E=function(e){var t=e.statuses,r=e.currentStatus,a=e.message;return Object(n.createElement)("span",{className:"sig-status sig-status--".concat(r)},"loading"===r?Object(n.createElement)(s.Spinner,null):Object(n.createElement)(v,{size:18,icon:"success"===r?h:w}),a||t[r])},x=function(e){var t=e.template,r=e.logo,o=e.editable,c=e.colors,i=void 0===c?{}:c,u=e.fallback,m=void 0===u?null:u,g=e.titleRef,b=void 0===g?null:g,p={};if(i)for(var f=0,d=Object.entries(i);f<d.length;f++){var O=l()(d[f],2),j=O[0],y=O[1];p["--color-".concat(j)]=y}return m&&(p["--fallback"]="url(".concat(m,")")),Object(n.createElement)("div",{className:"sig-preview","data-template":t,style:p},Object(n.createElement)("span",{className:"sig-preview__logo","data-type":r.type},"title"===r.type&&Object(n.createElement)(n.Fragment,null,socialImageGenerator.siteTitle),"link"===r.type&&Object(n.createElement)(n.Fragment,null,socialImageGenerator.siteLink),"text"===r.type&&Object(n.createElement)(n.Fragment,null,r.text),"image"===r.type&&r.url&&r.width&&(o?Object(n.createElement)(s.ResizableBox,{className:"sig-preview__logo-img",size:{width:r.width,height:r.width*(r.image.height/r.image.width)},style:{display:"flex",alignItems:"stretch",justifyContent:"stretch"},minHeight:"25",minWidth:"25",maxHeight:"500",maxWidth:"1100",showHandle:o,lockAspectRatio:!0,enable:{top:!1,right:!1,bottom:!1,left:!1,topRight:!1,bottomRight:o,bottomLeft:!1,topLeft:!1},onResizeStop:function(e,t,n,a){r.setWidth(parseInt(r.width+a.width,10))}},Object(n.createElement)("img",{src:r.url})):Object(n.createElement)("img",{src:r.url,style:{width:r.width}}))),Object(n.createElement)("p",{className:"sig-preview__post-title",contentEditable:o,spellcheck:"false",ref:b},Object(a.__)("Example Post Title","social-image-generator")))},S=function(e){var t=e.name,r=e.slug,a=e.onClick,o=e.disabled;return Object(n.createElement)(s.Button,{className:"sig-editor__template-picker-item",onClick:a,disabled:o},o&&Object(n.createElement)("span",{className:"sig-editor__template-picker-icon"},Object(n.createElement)(v,{size:18,icon:h})),Object(n.createElement)("p",{className:"sig-editor__template-picker-title"},t),Object(n.createElement)("img",{className:"sig-editor__template-picker-preview",src:"".concat(socialImageGenerator.imgUrl,"thumbnails/").concat(r,".png")}))},k=function(e){var t=e.color,r=e.label,o=e.onChange,c=Object(n.useState)(!1),i=l()(c,2),u=i[0],m=i[1];return Object(n.createElement)("button",{className:"sig-editor__color-option",onClick:function(){return m(!0)},style:{"--color":t}},u&&Object(n.createElement)(s.Popover,{position:"bottom left",onClose:function(){return m(!1)},noArrow:!1},Object(n.createElement)(s.ColorPicker,{color:t,onChangeComplete:function(e){return o(e.hex)},disableAlpha:!0})),Object(a.sprintf)("%s Color",r.charAt(0).toUpperCase()+r.slice(1)))};function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var P={loading:Object(a.__)("Saving changes...","social-image-generator"),success:Object(a.__)("Changes saved successfully!","social-image-generator"),error:Object(a.__)("Something went wrong, please try again later.","social-image-generator")},I=function(e){var t,r,o,i=e.settings,u=e.onChange,g=e.onClose,p=Object(n.useState)((null==i||null===(t=i.logo)||void 0===t?void 0:t.width)||50),O=l()(p,2),j=O[0],y=O[1],v=Object(n.useState)((null==i?void 0:i.fallback)||null),_=l()(v,2),h=_[0],w=_[1],C=Object(n.useState)((null==i||null===(r=i.logo)||void 0===r?void 0:r.type)||"title"),I=l()(C,2),T=I[0],G=I[1],F=Object(n.useState)((null==i||null===(o=i.logo)||void 0===o?void 0:o.text)||""),R=l()(F,2),U=R[0],L=R[1],A=Object(n.useState)((null==i?void 0:i.logo)||null),D=l()(A,2),B=D[0],M=D[1],z=Object(n.useState)(!1),$=l()(z,2),q=$[0],W=$[1],H=Object(n.useState)("idle"),K=l()(H,2),V=K[0],X=K[1],J=Object(n.useState)((null==i?void 0:i.template)?socialImageGenerator.templates[i.template]:socialImageGenerator.templates.twentytwenty),Y=l()(J,2),Q=Y[0],Z=Y[1],ee=Object(n.useState)((null==i?void 0:i.colors)||Q.colors),te=l()(ee,2),re=te[0],ne=te[1],ae=Object(n.useState)(null),oe=l()(ae,2),ce=oe[0],ie=oe[1],le=Object(n.useRef)(null),se=Object(n.useRef)(null),ue=Object(n.useRef)(null);Object(n.useEffect)((function(){ie(le.current.textContent),le.current.addEventListener("input",(function(){ie(le.current.textContent)}))}),[]),Object(n.useEffect)((function(){for(var e=0,t=Object.entries(re);e<t.length;e++){var r=l()(t[e],2),n=r[0],a=r[1];se.current.style.setProperty("--color-".concat(n),a)}}),[re]),Object(n.useEffect)((function(){h?se.current.style.setProperty("--fallback","url(".concat(h.url,")")):se.current.style.removeProperty("--fallback")}),[h]);var me=function(){var e=b()(m.a.mark((function e(){var t,r,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("loading"!==V){e.next=2;break}return e.abrupt("return");case 2:return X("loading"),t=f.a.stringifyUrl({url:"".concat(socialImageGenerator.defaultApiUrl,"/settings")}),r=N({template:Q.slug,colors:re,logo:N(N({type:T},B?{id:B.id,width:j}:{}),"text"===T?{text:U}:{})},h?{fallback:h}:{}),e.prev=5,e.next=8,fetch(t,{method:"POST",headers:{"X-WP-Nonce":socialImageGenerator.nonce,"Content-Type":"application/json"},body:JSON.stringify({sig_template_settings:r})});case 8:n=e.sent,X(200===n.status?"success":"error"),200===n.status&&u(N(N({},r),{},{logo:N({url:B.url},r.logo)})),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),X("error");case 16:setTimeout((function(){X("idle")}),4e3);case 17:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(){return e.apply(this,arguments)}}();return Object(n.createElement)(s.SlotFillProvider,null,Object(n.createElement)(s.Popover.Slot,null),Object(n.createElement)(s.Modal,{title:Object(a.__)("Edit Template","social-image-generator"),onRequestClose:function(){return g()},shouldCloseOnClickOutside:!1},Object(n.createElement)("div",{className:"sig-editor",ref:se,"data-status":V},Object(n.createElement)("div",{className:"sig-preview-wrapper"},Object(n.createElement)(x,{template:Q.slug,logo:{type:T,text:U,image:B,url:B.url,width:j,setWidth:y},fallback:null==h?void 0:h.url,editable:!0,titleRef:le}),Object(n.createElement)("div",{className:"sig-preview-wrapper__caption"},Object(n.createElement)("span",{className:"sig-preview-wrapper__title"},ce),Object(n.createElement)("span",{className:"sig-preview-wrapper__url"},socialImageGenerator.siteLink))),Object(n.createElement)("div",{className:"sig-editor__controls"},Object(n.createElement)("div",{className:"sig-editor__control sig-editor__control--template"},Object(n.createElement)("img",{className:"sig-editor__template-preview",src:"".concat(socialImageGenerator.imgUrl,"thumbnails/").concat(Q.slug,".png")}),Object(n.createElement)("div",null,Object(n.createElement)("strong",null,Q.name)),Object(n.createElement)(s.Button,{isSecondary:!0,onClick:function(){W(!0),setTimeout((function(){se.current.parentElement.parentElement.scrollTo({top:ue.current.offsetTop-60,behavior:"smooth"})}),0)}},Object(a.__)("Change Template","social-image-generator"))),Object(n.createElement)("div",{className:"sig-editor__control"},Object(n.createElement)("h3",null,Object(a.__)("Logo","social-image-generator")),Object(n.createElement)(s.RadioControl,{selected:T,options:[{label:Object(a.__)("Site Title","social-image-generator"),value:"title"},{label:Object(a.__)("Site Link","social-image-generator"),value:"link"},{label:Object(a.__)("Image","social-image-generator"),value:"image"},{label:Object(a.__)("Text","social-image-generator"),value:"text"},{label:Object(a.__)("No Logo","social-image-generator"),value:"none"}],onChange:function(e){return G(e)}}),"image"===T&&Object(n.createElement)(d.MediaUpload,{onSelect:function(e){return M(e)},allowedTypes:["image"],render:function(e){var t=e.open;return Object(n.createElement)("p",null,Object(n.createElement)(s.Button,{isSecondary:!0,onClick:t,disabled:"loading"===V},B?Object(a.__)("Change Logo","social-image-generator"):Object(a.__)("Choose Logo","social-image-generator")))}}),"text"===T&&Object(n.createElement)(s.TextControl,{value:U,label:Object(a.__)("Logo Text","social-image-generator"),onChange:function(e){return L(e)}})),Object(n.createElement)("div",{className:"sig-editor__control"},Object(n.createElement)("h3",null,Object(a.__)("Colors","social-image-generator")),Object.entries(re).map((function(e){var t=l()(e,2),r=t[0],a=t[1];return"logo"===r&&["image","none"].includes(T)?Object(n.createElement)(n.Fragment,null):Object(n.createElement)(k,{label:r,color:a,onChange:function(e){return ne(N(N({},re),{},c()({},r,e)))}})}))),Q.image&&Object(n.createElement)("div",{className:"sig-editor__control"},Object(n.createElement)("h3",null,Object(a.__)("Fallback Image","social-image-generator")),Object(n.createElement)("div",{className:"sig-editor__fallback-preview"},h&&h.url&&Object(n.createElement)("img",{src:h.url}),Object(n.createElement)("div",null,Object(a.__)("By default, this template will use the featured image of a post or page. You can define a fallback image that will be used when the post or page does not have a featured image.","social-image-generator"),Object(n.createElement)(d.MediaUpload,{onSelect:function(e){return w({id:e.id,url:e.url})},allowedTypes:["image"],render:function(e){var t=e.open;return Object(n.createElement)(s.Button,{isSecondary:!0,onClick:t,disabled:"loading"===V},h?Object(a.__)("Change Fallback Image","social-image-generator"):Object(a.__)("Choose Fallback Image","social-image-generator"))}}),h&&Object(n.createElement)(s.Button,{isLink:!0,isDestructive:!0,onClick:function(){return w(null)}},Object(a.__)("Remove Fallback Image","social-image-generator")))))),Object(n.createElement)("div",{className:"sig-editor__footer"},Object(n.createElement)(s.Button,{isPrimary:!0,onClick:function(){return me()},disabled:"loading"===V},Object(a.__)("Save Changes","social-image-generator")),"idle"!==V&&Object(n.createElement)(E,{statuses:P,currentStatus:V})),q&&Object(n.createElement)("div",{className:"sig-editor__template-picker",ref:ue},Object.values(socialImageGenerator.templates).map((function(e){return Object(n.createElement)(S,{name:e.name,slug:e.slug,disabled:e.slug===Q.slug,onClick:function(){Z(e),ne(e.colors),se.current.parentElement.parentElement.scrollTo(0,0),W(!1)}})}))))))};function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var F=function(){var e,t,r,o,c,i,u,m=socialImageGenerator.templates[(null===(e=socialImageGenerator.templateSettings)||void 0===e?void 0:e.template)||"twentytwenty"],g=Object(n.useState)(!1),b=l()(g,2),p=b[0],f=b[1],d=Object(n.useState)({template:(null==m?void 0:m.slug)||"twentytwenty",colors:(null===(t=socialImageGenerator.templateSettings)||void 0===t?void 0:t.colors)||m.colors,fallback:null===(r=socialImageGenerator.templateSettings)||void 0===r?void 0:r.fallback,logo:G({type:(null===(o=socialImageGenerator.templateSettings)||void 0===o||null===(c=o.logo)||void 0===c?void 0:c.type)||"title"},null===(i=socialImageGenerator.templateSettings)||void 0===i?void 0:i.logo)}),O=l()(d,2),j=O[0],y=O[1];return Object(n.createElement)(s.Card,{className:"sig-panel"},Object(n.createElement)(s.CardHeader,null,Object(a.__)("Template","social-image-generator")),Object(n.createElement)(s.CardBody,null,Object(n.createElement)("div",{className:"sig-row"},Object(n.createElement)("div",{className:"sig-row__title"},Object(a.__)("Template","social-image-generator")),Object(n.createElement)("div",{className:"sig-row__content"},p&&Object(n.createElement)(I,{settings:j,onClose:function(){return f(!1)},onChange:function(e){y(e)}}),Object(n.createElement)("div",{className:"sig-preview-wrapper"},Object(n.createElement)(x,{template:j.template,logo:j.logo,colors:j.colors,fallback:null==j||null===(u=j.fallback)||void 0===u?void 0:u.url,editable:!1}),Object(n.createElement)("div",{className:"sig-preview-wrapper__caption"},Object(n.createElement)("span",{className:"sig-preview-wrapper__title"},Object(a.__)("Example Post Title","social-image-generator")),Object(n.createElement)("span",{className:"sig-preview-wrapper__url"},socialImageGenerator.siteLink))),Object(n.createElement)("div",{className:"sig-row__actions"},Object(n.createElement)(s.Button,{className:"sig-row__button",isSecondary:!0,disabled:!1,onClick:function(){return f(!0)}},Object(a.__)("Edit Template","social-image-generator")))))))},R={loading:Object(a.__)("Saving license key...","social-image-generator"),success:Object(a.__)("License key verified!","social-image-generator"),error:Object(a.__)("Something went wrong, please try again later.","social-image-generator")},U=function(){var e=Object(n.useState)(socialImageGenerator.isValidLicenseKey?"success":"idle"),t=l()(e,2),r=t[0],o=t[1],c=Object(n.useState)(""),i=l()(c,2),u=i[0],g=i[1],p=Object(n.useState)(socialImageGenerator.licenseKey),d=l()(p,2),O=d[0],j=d[1],y=function(){var e=b()(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("loading"!==r){e.next=2;break}return e.abrupt("return");case 2:return o("loading"),g(null),t=f.a.stringifyUrl({url:"".concat(socialImageGenerator.apiUrl,"/activate-license"),query:{licenseKey:O}}),e.prev=5,e.next=8,fetch(t,{method:"POST",headers:{"X-WP-Nonce":socialImageGenerator.nonce}});case 8:return e.next=10,e.sent.json();case 10:n=e.sent,o("success"===n.code?"success":"error"),g(n.message),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(5),g(null),o("error");case 19:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(){return e.apply(this,arguments)}}();return Object(n.createElement)(s.Card,{className:"sig-panel"},Object(n.createElement)(s.CardHeader,null,Object(a.__)("License","social-image-generator")),Object(n.createElement)(s.CardBody,null,Object(n.createElement)("div",{className:"sig-row"},Object(n.createElement)("div",{className:"sig-row__title"},Object(a.__)("License Key","social-image-generator")),Object(n.createElement)("div",{className:"sig-row__content"},Object(n.createElement)("div",{className:"sig-row__actions"},Object(n.createElement)(s.TextControl,{value:O,onChange:function(e){return j(e)}}),Object(n.createElement)(s.Button,{className:"sig-row__button",isSecondary:!0,disabled:"loading"===r||!O,onClick:function(){y()}},Object(a.__)("Save License Key","social-image-generator"))),"idle"!==r&&Object(n.createElement)(E,{statuses:R,currentStatus:r,message:u}),Object(n.createElement)("div",{class:"sig-row__label"},Object(a.__)("Enter your license key to receive automatic updates. The license key can be found in the email you received. If you've lost your license key, please get in touch.","social-image-generator"))))))},L={loading:Object(a.__)("Clearing cache...","social-image-generator"),success:Object(a.__)("Cache cleared successfully!","social-image-generator"),error:Object(a.__)("Something went wrong, please try again later.","social-image-generator")},A=function(){var e=Object(n.useState)("idle"),t=l()(e,2),r=t[0],o=t[1],c=Object(n.useState)(socialImageGenerator.cacheDirectoryCount),i=l()(c,2),u=i[0],g=i[1];Object(n.useEffect)((function(){socialImageGenerator.cacheDirectoryCount=u}),[u]);var p=function(){var e=b()(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("loading"!==r){e.next=2;break}return e.abrupt("return");case 2:return o("loading"),t=f.a.stringifyUrl({url:"".concat(socialImageGenerator.apiUrl,"/clear-cache"),query:{_wpnonce:socialImageGenerator.nonce}}),e.prev=4,e.next=7,fetch(t);case 7:n=e.sent,o(200===n.status?"success":"error"),200===n.status&&g(0),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),o("error");case 15:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(){return e.apply(this,arguments)}}();return Object(n.createElement)(s.Card,{className:"sig-panel"},Object(n.createElement)(s.CardHeader,null,Object(a.__)("Cache","social-image-generator")),Object(n.createElement)(s.CardBody,null,Object(n.createElement)("div",{className:"sig-row"},Object(n.createElement)("div",{className:"sig-row__title"},Object(a.__)("Image Folder","social-image-generator")),Object(n.createElement)("div",{className:"sig-row__content"},Object(n.createElement)("code",null,socialImageGenerator.cacheDirectory),Object(n.createElement)(E,{statuses:{success:Object(a.__)("Everything is working correctly!","social-image-generator"),error:Object(a.__)("Directory not writable! This means Social Image Generator won't be able to function correctly. Please contact your host and ask them to resolve this issue.","social-image-generator")},currentStatus:socialImageGenerator.cacheDirectoryWritable?"success":"error"}),Object(n.createElement)("div",{class:"sig-row__label"},Object(a.sprintf)(Object(a.__)("This is where Social Image Generator saves all generated images. Number of images saved: %d","social-image-generator"),u)))),Object(n.createElement)("div",{className:"sig-row"},Object(n.createElement)("div",{className:"sig-row__title"},Object(a.__)("Refresh Images","social-image-generator")),Object(n.createElement)("div",{className:"sig-row__content"},Object(n.createElement)("div",{className:"sig-row__actions"},Object(n.createElement)(s.Button,{className:"sig-row__button",isSecondary:!0,disabled:"success"===r,onClick:function(){p()}},Object(a.__)("Clear Cache","social-image-generator")),"idle"!==r&&Object(n.createElement)(E,{statuses:L,currentStatus:r})),Object(n.createElement)("div",{class:"sig-row__label"},Object(a.__)("Social Image Generator automatically generates new images when necessary and saves them in the folder above. If something went wrong, you can clear the cache manually to regenerate all images.","social-image-generator"))))))},D=function(){return Object(n.createElement)(n.Fragment,null,Object(n.createElement)(F,null),Object(n.createElement)(U,null),Object(n.createElement)(A,null))},B=r(11),M=r(10),z=r(12),$=r(13),q=Object(M.withSelect)((function(e){var t=e("core/editor").getEditedPostAttribute("featured_media");return{title:e("core/editor").getPostEdits().title||e("core/editor").getCurrentPost().title,image:t?wp.data.select("core").getMedia(t):null,customText:e("core/editor").getEditedPostAttribute("meta").sig_custom_text}})),W=Object(M.withDispatch)((function(e){return{setCustomText:function(t){e("core/editor").editPost({meta:{sig_custom_text:t}})}}})),H=function(e){var t=e.title,r=e.image,o=e.customText,c=e.setCustomText,i=Object(n.useState)(""),u=l()(i,2),m=u[0],g=u[1];Object(n.useEffect)((function(){var e=setTimeout((function(){g(t)}),500);return function(){clearTimeout(e)}}),[t]);var b=f.a.stringifyUrl({url:"".concat(socialImageGenerator.apiUrl,"/generator"),query:{_wpnonce:socialImageGenerator.nonce,text:o||m,image:r?r.source_url:null}},{skipNull:!0});return Object(n.createElement)($.PluginDocumentSettingPanel,{name:"social-image-generator",title:Object(a.__)("Social Image Preview","social-image-generator"),className:"sig-sidebar"},Object(n.createElement)("img",{className:"sig-sidebar__preview",src:b}),Object(n.createElement)(s.TextControl,{value:o,onChange:function(e){return c(e)},label:Object(a.__)("Custom Text","social-image-generator")}),Object(n.createElement)(s.ExternalLink,{href:"tools.php?page=social-image-generator"},Object(a.__)("Edit Social Image Template","social-image-generator")))},K=document.querySelector("#social-image-generator-settings");K&&Object(n.render)(Object(n.createElement)(D,null),K),Object(z.registerPlugin)("social-image-generator",{render:Object(B.compose)(q,W)(H),icon:!1})}]);